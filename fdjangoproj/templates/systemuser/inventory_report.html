{% load static %}
{% load tz %}
{% include "partials/header.html" %}

<body class="sb-nav-fixed">
    {% include "partials/navbar.html" %}
    <div id="layoutSidenav">
        {% include "partials/sidebar.html" %}

        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4 mt-4">
                    <h1 class="mb-4">Inventory Report</h1>

                    <!-- ðŸ” Filter Form -->
                    <form method="get" class="row g-3 mb-4">
                        <div class="col-md-3">{{ form.start_date.label_tag }} {{ form.start_date }}</div>
                        <div class="col-md-3">{{ form.end_date.label_tag }} {{ form.end_date }}</div>
                        <div class="col-md-3">{{ form.category.label_tag }} {{ form.category }}</div>
                        <div class="col-md-3 d-flex align-items-end">
                            <button type="submit" class="btn btn-primary w-100">
                                <i class="fa-solid fa-filter me-2"></i> Apply Filter
                            </button>
                        </div>
                    </form>

                    <!-- Export Button -->
                    <a href="?export=excel" class="btn btn-success mb-3">
                        <i class="fa-solid fa-file-excel me-2"></i> Export to Excel
                    </a>

                    <!-- ðŸ“Š Summary Cards -->
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <div class="card text-bg-success shadow-sm">
                                <div class="card-body d-flex justify-content-between align-items-center">
                                    <div>
                                        <div class="small text-white-50">Total Quantity</div>
                                        <div class="fs-4 fw-bold">{{ total_quantity }}</div>
                                    </div>
                                    <i class="fa-solid fa-boxes-stacked fa-2x opacity-75"></i>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card text-bg-primary shadow-sm">
                                <div class="card-body d-flex justify-content-between align-items-center">
                                    <div>
                                        <div class="small text-white-50">Total Inventory Value</div>
                                        <div class="fs-4 fw-bold">â‚±{{ total_value|floatformat:2 }}</div>
                                    </div>
                                    <i class="fa-solid fa-coins fa-2x opacity-75"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ðŸ“‹ Inventory Table -->
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <table id="datatablesSimple" class="table table-striped align-middle">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Item Name</th>
                                        <th>Category</th>
                                        <th>Quantity</th>
                                        <th>Price</th>
                                        <th>Total Value</th>
                                        <th>Date Added</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in items %}
                                    <tr>
                                        <td>{{ item.item_id }}</td>
                                        <td>{{ item.item_name }}</td>
                                        <td>{{ item.category.name }}</td>
                                        <td>{{ item.quantity }}</td>
                                        <td>â‚±{{ item.price }}</td>
                                        <td>â‚±{{ item.quantity|floatformat:0|add:item.price }}</td>
                                        <td>{{ item.date_added|date:"Y-m-d" }}</td>
                                    </tr>
                                    {% empty %}
                                    <tr>
                                        <td colspan="7" class="text-center text-muted py-3">
                                            No items found for the selected filters.
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
            {% include "partials/footer.html" %}
        </div>
    </div>

    {% include "partials/scripts.html" %}
</body>
</html>
